<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Geodata &amp; Spatial Regression - 7&nbsp; Spatial Impacts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08_exercise1.html" rel="next">
<link href="./06_regression-estimation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_impacts.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial Impacts</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Geodata &amp; Spatial Regression</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ruettenauer/Geodata_Spatial_Regression/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_refresher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Refresher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Manipulation &amp; Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spatial Relationships W</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_dependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Detecting Spatial Dependence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_regression-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spatial Regression Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_regression-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial Regression Models: Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_impacts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial Impacts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_exercise1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Comparing and Selecting Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_spatiotemporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Spatio-temporal models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Other Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_exercise2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#required-packages" id="toc-required-packages" class="nav-link active" data-scroll-target="#required-packages"><span class="header-section-number">7.0.1</span> Required packages</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">7.0.2</span> Session info</a></li>
  <li><a href="#reload-data-from-pervious-session" id="toc-reload-data-from-pervious-session" class="nav-link" data-scroll-target="#reload-data-from-pervious-session"><span class="header-section-number">7.0.3</span> Reload data from pervious session</a></li>
  <li><a href="#coefficient-estimates-neq-marginal-effects" id="toc-coefficient-estimates-neq-marginal-effects" class="nav-link" data-scroll-target="#coefficient-estimates-neq-marginal-effects"><span class="header-section-number">7.1</span> Coefficient estimates <span class="math inline">\(\neq\)</span> `marginal’ effects</a></li>
  <li><a href="#global-and-local-spillovers" id="toc-global-and-local-spillovers" class="nav-link" data-scroll-target="#global-and-local-spillovers"><span class="header-section-number">7.2</span> Global and local spillovers</a></li>
  <li><a href="#impact-measures" id="toc-impact-measures" class="nav-link" data-scroll-target="#impact-measures"><span class="header-section-number">7.3</span> Impact measures</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Spatial Impacts</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="required-packages" class="level3" data-number="7.0.1">
<h3 data-number="7.0.1" class="anchored" data-anchor-id="required-packages"><span class="header-section-number">7.0.1</span> Required packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"tmap"</span>, <span class="st">"viridisLite"</span>) <span class="co"># note: load spdep first, then spatialreg</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pkgs, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="session-info" class="level3" data-number="7.0.2">
<h3 data-number="7.0.2" class="anchored" data-anchor-id="session-info"><span class="header-section-number">7.0.2</span> Session info</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default


locale:
[1] LC_COLLATE=English_United Kingdom.utf8 
[2] LC_CTYPE=English_United Kingdom.utf8   
[3] LC_MONETARY=English_United Kingdom.utf8
[4] LC_NUMERIC=C                           
[5] LC_TIME=English_United Kingdom.utf8    

time zone: Europe/London
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods  
[7] base     

other attached packages:
[1] viridisLite_0.4.2 tmap_3.3-3        spatialreg_1.2-9 
[4] Matrix_1.5-4.1    spdep_1.2-8       spData_2.2.2     
[7] mapview_2.11.0    sf_1.0-13        

loaded via a namespace (and not attached):
 [1] xfun_0.39          raster_3.6-20      htmlwidgets_1.6.2 
 [4] lattice_0.21-8     vctrs_0.6.3        tools_4.3.1       
 [7] crosstalk_1.2.0    LearnBayes_2.15.1  generics_0.1.3    
[10] parallel_4.3.1     stats4_4.3.1       sandwich_3.0-2    
[13] tibble_3.2.1       proxy_0.4-27       fansi_1.0.4       
[16] pkgconfig_2.0.3    KernSmooth_2.23-21 satellite_1.0.4   
[19] RColorBrewer_1.1-3 leaflet_2.1.2      webshot_0.5.4     
[22] lifecycle_1.0.3    compiler_4.3.1     deldir_1.0-9      
[25] munsell_0.5.0      terra_1.7-29       leafsync_0.1.0    
[28] codetools_0.2-19   stars_0.6-1        htmltools_0.5.5   
[31] class_7.3-22       pillar_1.9.0       MASS_7.3-60       
[34] classInt_0.4-9     lwgeom_0.2-13      wk_0.7.3          
[37] abind_1.4-5        boot_1.3-28.1      multcomp_1.4-24   
[40] nlme_3.1-162       tidyselect_1.2.0   digest_0.6.31     
[43] mvtnorm_1.2-2      dplyr_1.1.2        splines_4.3.1     
[46] fastmap_1.1.1      grid_4.3.1         colorspace_2.1-0  
[49] expm_0.999-7       cli_3.6.1          magrittr_2.0.3    
[52] base64enc_0.1-3    dichromat_2.0-0.1  XML_3.99-0.14     
[55] survival_3.5-5     utf8_1.2.3         TH.data_1.1-2     
[58] leafem_0.2.0       e1071_1.7-13       scales_1.2.1      
[61] sp_1.6-1           rmarkdown_2.22     zoo_1.8-12        
[64] png_0.1-8          coda_0.19-4        evaluate_0.21     
[67] knitr_1.43         tmaptools_3.1-1    s2_1.1.4          
[70] rlang_1.1.1        Rcpp_1.0.10        glue_1.6.2        
[73] DBI_1.1.3          jsonlite_1.8.5     R6_2.5.1          
[76] units_0.8-2       </code></pre>
</div>
</div>
</section>
<section id="reload-data-from-pervious-session" class="level3" data-number="7.0.3">
<h3 data-number="7.0.3" class="anchored" data-anchor-id="reload-data-from-pervious-session"><span class="header-section-number">7.0.3</span> Reload data from pervious session</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"_data/msoa2_spatial.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="coefficient-estimates-neq-marginal-effects" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="coefficient-estimates-neq-marginal-effects"><span class="header-section-number">7.1</span> Coefficient estimates <span class="math inline">\(\neq\)</span> `marginal’ effects</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Do not interpret coefficients as marginal effects in SAR, SAC, and SDM!!</p>
</div>
</div>
<p>At first glance, the specifications presented above seem relatively similar in the way of modelling spatial effects. <strong>Yet, they differ in very important aspects</strong>.</p>
<p>First, models with an endogenous spatial term (SAR, SAC, and SDM) assume a very different spatial dependence structure than models with only exogenous spatial terms as SLX and SDEM specifications. While the first three assume <strong>global</strong> spatial dependence, the second two assume <strong>local</strong> spatial dependence <span class="citation" data-cites="Anselin.2003 HalleckVega.2015 LeSage.2009">(<a href="references.html#ref-Anselin.2003" role="doc-biblioref">Anselin 2003</a>; <a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">Halleck Vega and Elhorst 2015</a>; <a href="references.html#ref-LeSage.2009" role="doc-biblioref">LeSage and Pace 2009</a>)</span>.</p>
<p>Second, the interpretation of the coefficients differs greatly between models with and without endogenous effects. This becomes apparent when considering the reduced form of the equations above. Exemplary using the SAR model, the reduced form is given by:</p>
<p><span class="math display">\[
{\boldsymbol{\mathbf{y}}}-\rho{\boldsymbol{\mathbf{W}}}{\boldsymbol{\mathbf{y}}} ={\boldsymbol{\mathbf{X}}}{\boldsymbol{\mathbf{\beta}}}+ {\boldsymbol{\mathbf{\varepsilon}}}, \nonumber \\
({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}}){\boldsymbol{\mathbf{y}}}={\boldsymbol{\mathbf{X}}}{\boldsymbol{\mathbf{\beta}}}+ {\boldsymbol{\mathbf{\varepsilon}}}\nonumber, \\
{\boldsymbol{\mathbf{y}}} =({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}})^{-1}({\boldsymbol{\mathbf{X}}}{\boldsymbol{\mathbf{\beta}}}+ {\boldsymbol{\mathbf{\varepsilon}}}),
\]</span> where <span class="math inline">\({\boldsymbol{\mathbf{I}}_N}\)</span> is an <span class="math inline">\(N \times N\)</span> diagonal matrix (diagonal elements equal 1, 0 otherwise). This contains no spatially lagged dependent variable on the right-hand side.</p>
<p>If we want to interpret coefficient, we are usually in marginal or partial effects (the association between a unit change in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>). We obtain these effects by looking at the first derivative.</p>
<p>When taking the first derivative of the explanatory variable <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> from the reduced form in (<span class="math inline">\(\ref{eq:sarred}\)</span>) to interpret the partial effect of a unit change in variable <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> on <span class="math inline">\({\boldsymbol{\mathbf{y}}}\)</span>, we receive</p>
<p><span class="math display">\[
\frac{\partial {\boldsymbol{\mathbf{y}}}}{\partial {\boldsymbol{\mathbf{x}}}_k}=\underbrace{({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}})^{-1}}_{N \times N}\beta_k,
\]</span></p>
<p>for each covariate <span class="math inline">\(k=\{1,2,...,K\}\)</span>. As can be seen, the partial derivative with respect to <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> produces an <span class="math inline">\(N \times N\)</span> matrix, thereby representing the partial effect of each unit <span class="math inline">\(i\)</span> onto the focal unit <span class="math inline">\(i\)</span> itself and all other units .</p>
<p>Note that the diagonal elements of <span class="math inline">\(({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}})^{-1}\)</span> are not zero anymore (as they are in <span class="math inline">\(\boldsymbol{\mathbf{W}}\)</span>). Look at the following minimal example:</p>
<p><span class="math display">\[
\begin{split}
\tilde{\boldsymbol{\mathbf{W}}} = \begin{pmatrix}
      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
      1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
      1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0
      \end{pmatrix}, \mathrm{and~normalized} ~
\boldsymbol{\mathbf{W}} = \begin{pmatrix}
      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0 \\
      0.33 &amp; 0 &amp; 0.33 &amp; 0 &amp; 0.33 \\
      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0 \\
      0.33 &amp; 0 &amp; 0.33 &amp; 0 &amp; 0.33 \\
      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0
      \end{pmatrix}      
\end{split}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\rho = 0.6,
\]</span></p>
<p>then</p>
<p><span class="math display">\[
\begin{split}
\rho \boldsymbol{\mathbf{W}} = \begin{pmatrix}
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 \\
      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 \\
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 \\
      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 \\
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0
      \end{pmatrix}.
\end{split}
\]</span></p>
<p>If we want to get the total effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> we need to add the direct association wihtin <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> and so on…</p>
<p><span class="math display">\[
\begin{split}
\boldsymbol{\mathbf{I}}_N - \rho \boldsymbol{\mathbf{W}} &amp;=
\begin{pmatrix}
      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
      0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
      0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
      0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
      0 &amp; 1 &amp; 0 &amp; 0 &amp; 1
      \end{pmatrix} -
\begin{pmatrix}
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 \\
      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 \\
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 \\
      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 \\
      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0
      \end{pmatrix}\\
&amp; = \begin{pmatrix}
      1 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 0 \\
      -0.2 &amp; 1 &amp; -0.2 &amp; 0 &amp; -0.2 \\
      0 &amp; 0.3 &amp; 1 &amp; 0.3 &amp; 0 \\
      -0.2 &amp; 0 &amp; -0.2 &amp; 1 &amp; -0.2 \\
      0 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 1
      \end{pmatrix}.
\end{split}
\]</span></p>
<p>And finally we take the inverse of that</p>
<p><span class="math display">\[
\begin{split}
(\boldsymbol{\mathbf{I}}_N - \rho \boldsymbol{\mathbf{W}})^{-1} &amp;=
\begin{pmatrix}
      1 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 0 \\
      -0.2 &amp; 1 &amp; -0.2 &amp; 0 &amp; -0.2 \\
      0 &amp; 0.3 &amp; 1 &amp; 0.3 &amp; 0 \\
      -0.2 &amp; 0 &amp; -0.2 &amp; 1 &amp; -0.2 \\
      0 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 1
      \end{pmatrix}^{-1}\\
&amp;=
\begin{pmatrix}
      \color{red}{1.1875} &amp; 0.46875 &amp; 0.1875 &amp; 0.46875 &amp; 0.1875 \\
      0.3125 &amp; \color{red}{1.28125} &amp; 0.3125 &amp; 0.28125 &amp; 0.3125 \\
      0.1875 &amp; 0.46875 &amp; \color{red}{1.1875} &amp; 0.46875 &amp; 0.1875 \\
      0.3125 &amp; 0.28125 &amp; 0.3125 &amp; \color{red}{1.28125} &amp; 0.3125 \\
      0.1875 &amp; 0.46875 &amp; 0.1875 &amp; 0.46875 &amp; \color{red}{1.1875}
      \end{pmatrix}.
\end{split}
\]</span></p>
<p>As you can see, <span class="math inline">\((\boldsymbol{\mathbf{I}}_N - \rho \boldsymbol{\mathbf{W}})^{-1}\)</span> has <span class="math inline">\(&gt;1\)</span>: these are feedback loops. My <span class="math inline">\(X\)</span> influences my <span class="math inline">\(Y\)</span> directly, but my <span class="math inline">\(Y\)</span> then influences my neigbour’s <span class="math inline">\(Y\)</span>, which then influences my <span class="math inline">\(Y\)</span> again (also also other neighbour’s <span class="math inline">\(Y\)</span>s). Thus the influence of my <span class="math inline">\(X\)</span> on my <span class="math inline">\(Y\)</span> includes a spatial multiplier.</p>
<p>Check yourself:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>I <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.6</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>(<span class="at">IrW =</span> I <span class="sc">-</span> rho<span class="sc">*</span>W)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]  1.0 -0.3  0.0 -0.3  0.0
[2,] -0.2  1.0 -0.2  0.0 -0.2
[3,]  0.0 -0.3  1.0 -0.3  0.0
[4,] -0.2  0.0 -0.2  1.0 -0.2
[5,]  0.0 -0.3  0.0 -0.3  1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (I - rho*W)^-1</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">M =</span> <span class="fu">solve</span>(IrW))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]    [,2]   [,3]    [,4]   [,5]
[1,] 1.1875 0.46875 0.1875 0.46875 0.1875
[2,] 0.3125 1.28125 0.3125 0.28125 0.3125
[3,] 0.1875 0.46875 1.1875 0.46875 0.1875
[4,] 0.3125 0.28125 0.3125 1.28125 0.3125
[5,] 0.1875 0.46875 0.1875 0.46875 1.1875</code></pre>
</div>
</div>
<p>The diagonal elements of indicate how each unit <span class="math inline">\(i\)</span> influences itself (change of <span class="math inline">\(x_i\)</span> on change of <span class="math inline">\(y_i\)</span>), and each off-diagonal elements in column <span class="math inline">\(j\)</span> represents the effect of <span class="math inline">\(j\)</span> on each other unit <span class="math inline">\(i\)</span> (change of <span class="math inline">\(x_j\)</span> on change of <span class="math inline">\(y_i\)</span>).</p>
<p><span class="math display">\[
\begin{split}
\begin{pmatrix}
      1.1875 &amp; \color{red}{0.46875} &amp; 0.1875 &amp; 0.46875 &amp; 0.1875 \\
      0.3125 &amp; 1.28125 &amp; 0.3125 &amp; 0.28125 &amp; 0.3125 \\
      0.1875 &amp; 0.46875 &amp; 1.1875 &amp; 0.46875 &amp; 0.1875 \\
      0.3125 &amp; 0.28125 &amp; 0.3125 &amp; 1.28125 &amp; 0.3125 \\
      0.1875 &amp; 0.46875 &amp; \color{blue}{0.1875} &amp; 0.46875 &amp; 1.1875
      \end{pmatrix}.
\end{split}
\]</span></p>
<p>For instance, <span class="math inline">\(\color{red}{W_{12}}\)</span> indicates that unit 2 has an influence of 0.46875 on unit 1. On the other hand, <span class="math inline">\(\color{blue}{W_{53}}\)</span> indicates that unit 3 has an influence of magnitude 0.1875 on unit 5.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why does unit 3 have any effect o unit 5? According to <span class="math inline">\(\boldsymbol{\mathbf{W}}\)</span> those two units are no neighbours <span class="math inline">\(w_{53} = 0\)</span>!</p>
</div>
</div>
<!-- $$  -->
<!--    \begin{equation} -->
<!--    \begin{split} -->
<!--        {\bm y} & =\alpha{\bm \iota}+\rho {\bm W}{\bm y}+{\bm X}{\bm \beta}+{\bm \varepsilon} \\ -->
<!--        {\bm y} & =({\bm I}-\rho{\bm W})^{-1}(\alpha{\bm \iota}+{\bm X}{\bm \beta}+{\bm \varepsilon}), -->
<!--    \end{split} -->
<!--    \end{equation} -->
<!-- $$  -->
<!-- we can calculate the first derivative: -->
<!-- $$  -->
<!--    \begin{equation} -->
<!--    \begin{split} -->
<!--        \frac{\partial \bm y}{\partial \bm x_k} & = ({\bm I}-\rho{\bm W})^{-1}\beta_k \\ -->
<!--        & =({\bm I} + \rho{\bm W} + \rho^2{\bm W}^2 + \rho^3{\bm W}^3 + ...)\beta_k,  -->
<!--    \end{split} -->
<!--    \end{equation}   -->
<!-- $$  -->
<!--    where $\rho{\bm W}\beta_k$ equals the effect stemming from direct neighbours, $\rho^2{\bm W}^2\beta_k$ the effect stemming from second order neighbours (neighbours of neighbours),...  -->
<!-- for SAR, SAC, and SDM even the direct impacts differ from the point estimates. This results from the fact that an endogenous term of the dependent variable ${\bm W}{\bm y}$ contains feedback loops through the system of neighbours \citep{Betz.2019,Franzese.2007.0,HalleckVega.2015.0}. A change of $x_{i}$ in the focal unit $i$ influences the focal unit $i$ itself, but also the neighbouring unit $j$, which in turn influences the focal unit $i$ in a feedback loop. This feedback loop is part of the direct impact. -->
</section>
<section id="global-and-local-spillovers" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="global-and-local-spillovers"><span class="header-section-number">7.2</span> Global and local spillovers</h2>
<p>The kind of indirect spillover effects in SAR, SAC, and SDM models differs from the kind of indirect spillover effects in SLX and SDEM models: while the first three specifications represent <strong>global spillover effects</strong>, the latter three represent <strong>local spillover effects</strong> <span class="citation" data-cites="Anselin.2003 LeSage.2009 LeSage.2014">(<a href="references.html#ref-Anselin.2003" role="doc-biblioref">Anselin 2003</a>; <a href="references.html#ref-LeSage.2009" role="doc-biblioref">LeSage and Pace 2009</a>; <a href="references.html#ref-LeSage.2014" role="doc-biblioref">LeSage 2014</a>)</span>.</p>
<p>**Local* In case of SLX and SDEM the spatial spillover effects can be interpreted as the effect of a one unit change of <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> in the spatially weighted neighbouring observations on the dependent variable of the focal unit; when using a row-normalised contiguity weights matrix, <span class="math inline">\({\boldsymbol{\mathbf{W}}} {\boldsymbol{\mathbf{x}}}_k\)</span> is the average value of <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> in the neighbouring units. Thus, only direct neighbours – as defined in <span class="math inline">\({\boldsymbol{\mathbf{W}}}\)</span> – contribute to those local spillover effects.</p>
<p><strong>Global</strong> In contrast, spillover effects in SAR, SAC, and SDM models do not only include direct neighbours but also neighbours of neighbours (second order neighbours) and further higher-order neighbours. This can be seen by rewriting the inverse <span class="math inline">\(({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}})^{-1}\)</span> as power series:A power series of <span class="math inline">\(\sum\nolimits_{k=0}^\infty {\boldsymbol{\mathbf{W}}}^k\)</span> converges to <span class="math inline">\(({\boldsymbol{\mathbf{I}}}-{\boldsymbol{\mathbf{W}}})^{-1}\)</span> if the maximum absolute eigenvalue of <span class="math inline">\({\boldsymbol{\mathbf{W}}} &lt; 1\)</span>, which is ensured by standardising <span class="math inline">\({\boldsymbol{\mathbf{W}}}\)</span>.}</p>
<p><span class="math display">\[
\begin{split}
({\boldsymbol{\mathbf{I}}_N}-\rho {\boldsymbol{\mathbf{W}}})^{-1}\beta_k
=({\boldsymbol{\mathbf{I}}_N} + \rho{\boldsymbol{\mathbf{W}}} + \rho^2{\boldsymbol{\mathbf{W}}}^2 + \rho^3{\boldsymbol{\mathbf{W}}}^3 + ...)\beta_k
= ({\boldsymbol{\mathbf{I}}_N} + \sum_{h=1}^\infty \rho^h{\boldsymbol{\mathbf{W}}}^h)\beta_k ,
\end{split}
\]</span></p>
<p>where the identity matrix represents the direct effects and the sum represents the first and higher order indirect effects and the above mentioned feedback loops. This implies that a change in one unit <span class="math inline">\(i\)</span> does not only affect the direct neighbours but passes through the whole system towards higher-order neighbours, where the impact declines with distance within the neighbouring system. Global indirect impacts thus are `multiplied’ by influencing direct neighbours as specified in <span class="math inline">\(\boldsymbol{\mathbf{W}}\)</span> and indirect neighbours not connected according to <span class="math inline">\(\boldsymbol{\mathbf{W}}\)</span>, with additional feedback loops between those neighbours.</p>
<p>All diagonal elements <span class="math inline">\(\mathrm{diag}({\boldsymbol{\mathbf{W}}})=w_{ii}=0\)</span>, whereas the diagonal elements <span class="math inline">\(\mathrm{diag}({\boldsymbol{\mathbf{W}}}^2)=\mathrm{diag}({\boldsymbol{\mathbf{W}}}{\boldsymbol{\mathbf{W}}})\neq0\)</span>. Intuitively, <span class="math inline">\(\rho{\boldsymbol{\mathbf{W}}}\)</span> only represents the effects between direct neighbours (and the focal unit is not a neighbour of the focal unit itself), whereas <span class="math inline">\(\rho^2{\boldsymbol{\mathbf{W}}}^2\)</span> contains the effects of second order neighbours, where the focal unit is a second order neighbour of the focal unit itself. Thus, equation (<span class="math inline">\(\ref{eq:high}\)</span>) includes feedback effects from <span class="math inline">\(\rho^2{\boldsymbol{\mathbf{W}}}^2\)</span> on, which are part of the direct impacts according to the measures in Table <span class="math inline">\(\ref{table:imp}\)</span>.</p>
<p>In consequence, local and global spillover effects represent two distinct kinds of spatial spillover effects <span class="citation" data-cites="LeSage.2014">(<a href="references.html#ref-LeSage.2014" role="doc-biblioref">LeSage 2014</a>)</span>. The interpretation of local spillover effects is straightforward: it represents the effect of all neighbours as defined by <span class="math inline">\({\boldsymbol{\mathbf{W}}}\)</span> (the average over all neighbours in case of a row-normalised weights matrix). For instance, the environmental quality in the focal unit itself but also in neighbouring units could influence the attractiveness of a district and its house prices. In this example it seems reasonable to assume that we have local spillover effects: only the environmental quality in directly contiguous units (e.g.&nbsp;in walking distance) is relevant for estimating the house prices. In contrast, interpreting global spillover effects can be a bit more difficult. Intuitively, the global spillover effects can be seen as a kind of diffusion process. For example, an exogenous event might increase the house prices in one district of a city, thus leading to an adaptation of house prices in neighbouring districts, which then leads to further adaptations in other units (the neighbours of the neighbours), thereby globally diffusing the effect of the exogenous event due to the endogenous term. Yet, those processes happen over time. In a cross-sectional framework, the global spillover effects are hard to interpret. <span class="citation" data-cites="Anselin.2003">Anselin (<a href="references.html#ref-Anselin.2003" role="doc-biblioref">2003</a>)</span> proposes an interpretation as an equilibrium outcome, where the partial impact represents an estimate of how this long-run equilibrium would change due to a change in <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span> <span class="citation" data-cites="LeSage.2014">(<a href="references.html#ref-LeSage.2014" role="doc-biblioref">LeSage 2014</a>)</span>.</p>
</section>
<section id="impact-measures" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="impact-measures"><span class="header-section-number">7.3</span> Impact measures</h2>
<p>Note that the derivative in SAR, SAC, and SDM is a <span class="math inline">\(N \times N\)</span> matrix, returning individual effects of each unit on each other unit, differentiated in <em>direct, indirect, and total impacts</em>.</p>
<p><span class="math display">\[
\begin{split}
(\boldsymbol{\mathbf{I}}_N - \rho \boldsymbol{\mathbf{W}})^{-1} \beta &amp;=
\begin{pmatrix}
      \color{red}{1.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} \\
      \color{blue}{0.3125} &amp; \color{red}{1.28125} &amp; \color{blue}{0.3125} &amp; \color{blue}{0.28125} &amp; \color{blue}{0.3125} \\
      \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{red}{1.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} \\
      \color{blue}{0.3125} &amp; \color{blue}{0.28125} &amp; \color{blue}{0.3125} &amp; \color{red}{1.28125} &amp; \color{blue}{0.3125} \\
      \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{red}{1.1875}
      \end{pmatrix} \beta
\end{split}
\]</span></p>
<p><strong>However, the individual effects (how <span class="math inline">\(i\)</span> influences <span class="math inline">\(j\)</span>) mainly vary because of variation in <span class="math inline">\({\boldsymbol{\mathbf{W}}}\)</span>. </strong></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Do not interpret these as “estmated” individual impacts
</div>
</div>
<div class="callout-body-container callout-body">
<p>We estimate two scalar parameters in a SAR model: <span class="math inline">\(\beta\)</span> for the direct coefficient and <span class="math inline">\(rho\)</span> for the auto-regressive parameter.</p>
<p>All variation in the effects matrix (I_N - W)^{-1} comes from the relationship in <span class="math inline">\(\boldsymbol{\mathbf{W}}\)</span> which we have given a-priori!</p>
</div>
</div>
<p>Since reporting the individual partial effects is usually not of interest, <span class="citation" data-cites="LeSage.2009">LeSage and Pace (<a href="references.html#ref-LeSage.2009" role="doc-biblioref">2009</a>)</span> proposed to average over these effect matrices. While the average diagonal elements of the effects matrix <span class="math inline">\((\boldsymbol{\mathbf{I}}_N - \rho \boldsymbol{\mathbf{W}})^{-1}\)</span> represent the so called direct impacts of variable <span class="math inline">\({\boldsymbol{\mathbf{x}}}_k\)</span>, the average column-sums of the off-diagonal elements represent the so called indirect impacts (or spatial spillover effects).</p>
<p>The refer to an average effect of a unit change in <span class="math inline">\(x_i\)</span> on <span class="math inline">\(y_i\)</span>, and indicate how a change in <span class="math inline">\(x_i\)</span>, on average, influences all neighbouring units <span class="math inline">\(y_j\)</span>.</p>
<p>Though previous literature <span class="citation" data-cites="HalleckVega.2015 LeSage.2009">(<a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">Halleck Vega and Elhorst 2015</a>; <a href="references.html#ref-LeSage.2009" role="doc-biblioref">LeSage and Pace 2009</a>)</span> has established the notation of direct and indirect impacts, it is important to note that also the direct impacts comprise a spatial `multiplier’ component if we specify an endogenous lagged depended variable, as a change in <span class="math inline">\(\boldsymbol{\mathbf{x}}_i\)</span> influences <span class="math inline">\(\boldsymbol{\mathbf{y}}_i\)</span>, which influences <span class="math inline">\(\boldsymbol{\mathbf{y}}_j\)</span>, which in turn influences <span class="math inline">\(\boldsymbol{\mathbf{y}}_i\)</span> (see also equation <span class="math inline">\(\ref{eq:high}\)</span>).</p>
<p>Usually, one should use summary measures to report effects in spatial models <span class="citation" data-cites="LeSage.2009">(<a href="references.html#ref-LeSage.2009" role="doc-biblioref">LeSage and Pace 2009</a>)</span>. <span class="citation" data-cites="HalleckVega.2015">Halleck Vega and Elhorst (<a href="references.html#ref-HalleckVega.2015" role="doc-biblioref">2015</a>)</span> provide a nice summary of the impacts for each model:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Direct Impacts</th>
<th style="text-align: center;">Indirect Impacts</th>
<th style="text-align: center;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">OLS/SEM</td>
<td style="text-align: center;"><span class="math inline">\(\beta_k\)</span></td>
<td style="text-align: center;">–</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="even">
<td style="text-align: center;">SAR/SAC</td>
<td style="text-align: center;">Diagonal elements of <span class="math inline">\(({\boldsymbol{\mathbf{I}}}-\rho{\boldsymbol{\mathbf{W}}})^{-1}\beta_k\)</span></td>
<td style="text-align: center;">Off-diagonal elements of <span class="math inline">\(({\boldsymbol{\mathbf{I}}}-\rho{\boldsymbol{\mathbf{W}}})^{-1}\beta_k\)</span></td>
<td style="text-align: center;">global</td>
</tr>
<tr class="odd">
<td style="text-align: center;">SLX/SDEM</td>
<td style="text-align: center;"><span class="math inline">\(\beta_k\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\theta_k\)</span></td>
<td style="text-align: center;">local</td>
</tr>
<tr class="even">
<td style="text-align: center;">SDM</td>
<td style="text-align: center;">Diagonal elements of <span class="math inline">\(({\boldsymbol{\mathbf{I}}}-\rho{\boldsymbol{\mathbf{W}}})^{-1}\left[\beta_k+{\boldsymbol{\mathbf{W}}}\theta_k\right]\)</span></td>
<td style="text-align: center;">Off-diagonal elements of <span class="math inline">\(({\boldsymbol{\mathbf{I}}}-\rho{\boldsymbol{\mathbf{W}}})^{-1}\)</span></td>
<td style="text-align: center;">global</td>
</tr>
</tbody>
</table>
<p>The different indirect effects / spatial effects mean conceptionally different things:</p>
<ul>
<li><p>Global spillover effects: SAR, SAC, SDM</p></li>
<li><p>Local spillover effects: SLX, SDEM</p></li>
</ul>
<p>We can calculate these impacts using <code>impacts()</code> with simulated distributions, e.g.&nbsp;for the SAR model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod_1.sar.imp <span class="ot">&lt;-</span> <span class="fu">impacts</span>(mod_1.sar, <span class="at">listw =</span> queens.lw, <span class="at">R =</span> <span class="dv">300</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1.sar.imp, <span class="at">zstats =</span> <span class="cn">TRUE</span>, <span class="at">short =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, exact):
                   Direct      Indirect         Total
log(POPDEN)  0.0287903745  0.1644079569  0.1931983314
per_mixed   -0.0019869314 -0.0113464081 -0.0133333396
per_asian    0.0001071969  0.0006121501  0.0007193471
per_black    0.0000876976  0.0005007987  0.0005884963
per_other    0.0028533982  0.0162943824  0.0191477806
per_owner   -0.0014413007 -0.0082305739 -0.0096718746
per_social  -0.0008052953 -0.0045986532 -0.0054039485
pubs_count   0.0044215476  0.0252493278  0.0296708754
========================================================
Simulation results ( variance matrix):
========================================================
Simulated standard errors
                  Direct     Indirect        Total
log(POPDEN) 0.0036787160 0.0232262378 0.0262112832
per_mixed   0.0018231322 0.0110212217 0.0128306793
per_asian   0.0001392472 0.0007965066 0.0009351105
per_black   0.0003141971 0.0018561350 0.0021691876
per_other   0.0008547561 0.0047977946 0.0056187665
per_owner   0.0002503272 0.0014290325 0.0016490971
per_social  0.0002395464 0.0014220859 0.0016511352
pubs_count  0.0006523112 0.0042466951 0.0048068537

Simulated z-values:
                Direct   Indirect      Total
log(POPDEN)  7.7122216  7.0471846  7.3270224
per_mixed   -1.0380816 -1.0044209 -1.0102743
per_asian    0.7749925  0.7803603  0.7800977
per_black    0.3116184  0.3187282  0.3178666
per_other    3.2935958  3.3716880  3.3800813
per_owner   -5.7563898 -5.8049859 -5.9041366
per_social  -3.4093351 -3.3124693 -3.3475816
pubs_count   6.8369318  6.0661146  6.2870118

Simulated p-values:
            Direct     Indirect   Total     
log(POPDEN) 1.2434e-14 1.8257e-12 2.3537e-13
per_mixed   0.29923208 0.31517579 0.31236391
per_asian   0.43834411 0.43517886 0.43533334
per_black   0.75533058 0.74993260 0.75058614
per_other   0.00098915 0.00074709 0.00072464
per_owner   8.5932e-09 6.4371e-09 3.5450e-09
per_social  0.00065121 0.00092476 0.00081520
pubs_count  8.0906e-12 1.3104e-09 3.2363e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative with traces (better for large W)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">as</span>(queens.lw, <span class="st">"CsparseMatrix"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>trMatc <span class="ot">&lt;-</span> <span class="fu">trW</span>(W, <span class="at">type=</span><span class="st">"mult"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>mod_1.sar.imp2 <span class="ot">&lt;-</span> <span class="fu">impacts</span>(mod_1.sar, <span class="at">tr =</span> trMatc, <span class="at">R =</span> <span class="dv">300</span>, <span class="at">Q =</span> <span class="dv">10</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1.sar.imp2, <span class="at">zstats =</span> <span class="cn">TRUE</span>, <span class="at">short =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
                   Direct      Indirect         Total
log(POPDEN)  2.872435e-02  0.1580842024  0.1868085531
per_mixed   -1.982375e-03 -0.0109099822 -0.0128923571
per_asian    1.069511e-04  0.0005886045  0.0006955556
per_black    8.749648e-05  0.0004815361  0.0005690326
per_other    2.846855e-03  0.0156676386  0.0185144932
per_owner   -1.437995e-03 -0.0079139948 -0.0093519902
per_social  -8.034485e-04 -0.0044217715 -0.0052252200
pubs_count   4.411408e-03  0.0242781427  0.0286895505
========================================================
Simulation results ( variance matrix):
========================================================
Simulated standard errors
                  Direct     Indirect        Total
log(POPDEN) 0.0039886977 0.0223343853 0.0258382410
per_mixed   0.0016811342 0.0095458376 0.0112169396
per_asian   0.0001362981 0.0007493332 0.0008850676
per_black   0.0002842287 0.0015911882 0.0018747028
per_other   0.0008342562 0.0045127155 0.0053247861
per_owner   0.0002596458 0.0013946996 0.0016352617
per_social  0.0002495559 0.0013937482 0.0016369494
pubs_count  0.0006693187 0.0040199319 0.0046269215

Simulated z-values:
                Direct   Indirect      Total
log(POPDEN)  7.2468640  7.0825716  7.2408348
per_mixed   -1.2304468 -1.2042668 -1.2092676
per_asian    0.8243974  0.8160572  0.8178613
per_black    0.3111288  0.3182718  0.3173100
per_other    3.4077798  3.4405313  3.4497348
per_owner   -5.5641524 -5.6638430 -5.7141117
per_social  -3.2321049 -3.1707906 -3.1924471
pubs_count   6.6744795  6.0927135  6.2589451

Simulated p-values:
            Direct     Indirect   Total     
log(POPDEN) 4.2655e-13 1.4151e-12 4.4587e-13
per_mixed   0.21852984 0.22848647 0.22656005
per_asian   0.40971379 0.41446741 0.41343637
per_black   0.75570272 0.75027879 0.75100836
per_other   0.00065494 0.00058057 0.00056114
per_owner   2.6343e-08 1.4802e-08 1.1028e-08
per_social  0.00122882 0.00152025 0.00141073
pubs_count  2.4811e-11 1.1101e-09 3.8759e-10</code></pre>
</div>
</div>
<p>The indirect effects in SAR, SAC, and SDM refer to global spillover effects. This means a change of <span class="math inline">\(x\)</span> in the focal units flows through the entire system of neighbours (direct nieightbours, neighbours of neighbours, …) influencing ‘their <span class="math inline">\(y\)</span>’. One can think of this as diffusion or a change in a long-term equilibrium.</p>
<p>For SLX models, nothing is gained from computing the impacts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">impacts</span>(mod_1.slx, <span class="at">listw =</span> queens.lw))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (SlX, glht):
                   Direct      Indirect         Total
log(POPDEN)  0.0335627962  0.0850708012  0.1186335974
per_mixed    0.0022571496 -0.0151886450 -0.0129314954
per_asian   -0.0003585447  0.0013001118  0.0009415671
per_black   -0.0003005913 -0.0023586750 -0.0026592663
per_other    0.0041954324  0.0143881180  0.0185835505
per_owner   -0.0011450496 -0.0068207119 -0.0079657615
per_social  -0.0005484313 -0.0003438866 -0.0008923179
pubs_count   0.0056502528  0.0158434338  0.0214936867</code></pre>
</div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Anselin.2003" class="csl-entry" role="listitem">
Anselin, Luc. 2003. <span>“Spatial <span>Externalities</span>, <span>Spatial Multipliers</span>, and <span>Spatial Econometrics</span>.”</span> <em>International Regional Science Review</em> 26 (2): 153–66. <a href="https://doi.org/10.1177/0160017602250972">https://doi.org/10.1177/0160017602250972</a>.
</div>
<div id="ref-HalleckVega.2015" class="csl-entry" role="listitem">
Halleck Vega, Solmaria, and J. Paul Elhorst. 2015. <span>“The <span>SLX Model</span>.”</span> <em>Journal of Regional Science</em> 55 (3): 339–63. <a href="https://doi.org/10.1111/jors.12188">https://doi.org/10.1111/jors.12188</a>.
</div>
<div id="ref-LeSage.2014" class="csl-entry" role="listitem">
LeSage, James P. 2014. <span>“What <span>Regional Scientists Need</span> to <span>Know</span> about <span>Spatial Econometrics</span>.”</span> <em>The Review of Regional Studies</em> 44 (1): 13–32. https://doi.org/<a href="https://dx.doi.org/10.2139/ssrn.2420725">https://dx.doi.org/10.2139/ssrn.2420725</a>.
</div>
<div id="ref-LeSage.2009" class="csl-entry" role="listitem">
LeSage, James P., and R. Kelley Pace. 2009. <em>Introduction to <span>Spatial Econometrics</span></em>. Statistics, <span>Textbooks</span> and <span>Monographs</span>. <span>Boca Raton</span>: <span>CRC Press</span>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06_regression-estimation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Spatial Regression Models: Estimation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08_exercise1.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb15" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>\newcommand{\Exp}{\mathrm{E}}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>\newcommand\given<span class="co">[</span><span class="ot">1</span><span class="co">][]</span>{\:#1\vert\:}</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>\newcommand{\Cov}{\mathrm{Cov}}</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>\newcommand{\Var}{\mathrm{Var}}</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>\newcommand{\rank}{\mathrm{rank}}</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>\newcommand{\bm}<span class="co">[</span><span class="ot">1</span><span class="co">]</span>{\boldsymbol{\mathbf{#1}}}</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Spatial Impacts</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">### Required packages</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message = FALSE, warning = FALSE, results = 'hide'}</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"mapview"</span>, <span class="st">"spdep"</span>, <span class="st">"spatialreg"</span>, <span class="st">"tmap"</span>, <span class="st">"viridisLite"</span>) <span class="co"># note: load spdep first, then spatialreg</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pkgs, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">### Session info</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reload data from pervious session</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"_data/msoa2_spatial.RData"</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression-results, echo=FALSE}</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Contiguity (Queens) neighbours weights</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>queens.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(msoa.spdf, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">queen =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">snap =</span> <span class="dv">1</span>) <span class="co"># we consider points in 1m distance as 'touching'</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>queens.lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(queens.nb,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>mod_1.sar <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log</span>(no2) <span class="sc">~</span> <span class="fu">log</span>(POPDEN) <span class="sc">+</span> per_mixed <span class="sc">+</span> per_asian <span class="sc">+</span> per_black <span class="sc">+</span> per_other <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                per_owner <span class="sc">+</span> per_social <span class="sc">+</span> pubs_count,  </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> msoa.spdf, </span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">listw =</span> queens.lw,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>mod_1.sem <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(<span class="fu">log</span>(no2) <span class="sc">~</span> <span class="fu">log</span>(POPDEN) <span class="sc">+</span> per_mixed <span class="sc">+</span> per_asian <span class="sc">+</span> per_black <span class="sc">+</span> per_other <span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>                per_owner <span class="sc">+</span> per_social <span class="sc">+</span> pubs_count,  </span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> msoa.spdf, </span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                     <span class="at">listw =</span> queens.lw,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Durbin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>mod_1.slx <span class="ot">&lt;-</span> <span class="fu">lmSLX</span>(<span class="fu">log</span>(no2) <span class="sc">~</span> <span class="fu">log</span>(POPDEN) <span class="sc">+</span> per_mixed <span class="sc">+</span> per_asian <span class="sc">+</span> per_black <span class="sc">+</span> per_other <span class="sc">+</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>                per_owner <span class="sc">+</span> per_social <span class="sc">+</span> pubs_count,  </span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> msoa.spdf, </span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">listw =</span> queens.lw, </span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Durbin =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coefficient estimates $\neq$ `marginal' effects</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>Do not interpret coefficients as marginal effects in SAR, SAC, and SDM!! </span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>At first glance, the specifications presented above seem relatively similar in the way of modelling spatial effects. **Yet, they differ in very important aspects**. </span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>First, models with an endogenous spatial term (SAR, SAC, and SDM) assume a very different spatial dependence structure than models with only exogenous spatial terms as SLX and SDEM specifications. While the first three assume **global** spatial dependence, the second two assume **local** spatial dependence <span class="co">[</span><span class="ot">@Anselin.2003; @HalleckVega.2015; @LeSage.2009</span><span class="co">]</span>. </span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>Second, the interpretation of the coefficients differs greatly between models with and without endogenous effects. This becomes apparent when considering the reduced form of the equations above. Exemplary using the SAR model, the reduced form is given by:</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>{\bm y}-\rho{\bm W}{\bm y} ={\bm X}{\bm \beta}+ {\bm \varepsilon}, \nonumber <span class="sc">\\</span></span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>({\bm I_N}-\rho {\bm W}){\bm y}={\bm X}{\bm \beta}+ {\bm \varepsilon}\nonumber, <span class="sc">\\</span></span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>{\bm y} =({\bm I_N}-\rho {\bm W})^{-1}({\bm X}{\bm \beta}+ {\bm \varepsilon}),</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>where ${\bm I_N}$ is an $N \times N$ diagonal matrix (diagonal elements equal 1, 0 otherwise). This contains no spatially lagged dependent variable on the right-hand side.</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>If we want to interpret coefficient, we are usually in marginal or partial effects (the association between a unit change in $X$ and $Y$). We obtain these effects by looking at the first derivative.</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>When taking the first derivative of the explanatory variable ${\bm x}_k$ from the reduced form in (\ref{eq:sarred}) to interpret the partial effect of a unit change in variable ${\bm x}_k$ on ${\bm y}$, we receive</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>\frac{\partial {\bm y}}{\partial {\bm x}_k}=\underbrace{({\bm I_N}-\rho {\bm W})^{-1}}_{N \times N}\beta_k,</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>for each covariate $k=<span class="sc">\{</span>1,2,...,K<span class="sc">\}</span>$. As can be seen, the partial derivative with respect to ${\bm x}_k$ produces an $N \times N$ matrix, thereby representing the partial effect of each unit $i$ onto the focal unit $i$ itself and all other units \textcolor{red}{$j=<span class="sc">\{</span>1,2,...,i-1,i+1,...,N<span class="sc">\}</span>$}. </span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>Note that the diagonal elements of $({\bm I_N}-\rho {\bm W})^{-1}$ are not zero anymore (as they are in $\bm W$). Look at the following minimal example:</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>\tilde{\bm W} = \begin{pmatrix}</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>      1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>      1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>      0 &amp; 1 &amp; 0 &amp; 1 &amp; 0</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}, \mathrm{and~normalized} ~</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>\bm W = \begin{pmatrix}</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>      0.33 &amp; 0 &amp; 0.33 &amp; 0 &amp; 0.33 <span class="sc">\\</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>      0.33 &amp; 0 &amp; 0.33 &amp; 0 &amp; 0.33 <span class="sc">\\</span></span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}      </span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>and </span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>\rho = 0.6,</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>then </span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>\rho \bm W = \begin{pmatrix}</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 <span class="sc">\\</span></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 <span class="sc">\\</span></span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}.</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>If we want to get the total effect of $X$ on $Y$ we need to add the direct association wihtin $i$ and $j$ and so on... </span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>\bm I_N - \rho \bm W &amp;=</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>      0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>      0 &amp; 1 &amp; 0 &amp; 0 &amp; 1</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix} - </span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 <span class="sc">\\</span></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>      0.2 &amp; 0 &amp; 0.2 &amp; 0 &amp; 0.2 <span class="sc">\\</span></span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 0 &amp; 0.3 &amp; 0</span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}<span class="sc">\\</span></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>&amp; = \begin{pmatrix}</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>      1 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>      -0.2 &amp; 1 &amp; -0.2 &amp; 0 &amp; -0.2 <span class="sc">\\</span></span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 1 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>      -0.2 &amp; 0 &amp; -0.2 &amp; 1 &amp; -0.2 <span class="sc">\\</span></span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>      0 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 1</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}.</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>And finally we take the inverse of that</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>(\bm I_N - \rho \bm W)^{-1} &amp;=</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>      1 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>      -0.2 &amp; 1 &amp; -0.2 &amp; 0 &amp; -0.2 <span class="sc">\\</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>      0 &amp; 0.3 &amp; 1 &amp; 0.3 &amp; 0 <span class="sc">\\</span></span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>      -0.2 &amp; 0 &amp; -0.2 &amp; 1 &amp; -0.2 <span class="sc">\\</span></span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>      0 &amp; -0.3 &amp; 0 &amp; -0.3 &amp; 1</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}^{-1}<span class="sc">\\</span></span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>&amp;=</span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>      \color{red}{1.1875} &amp; 0.46875 &amp; 0.1875 &amp; 0.46875 &amp; 0.1875 <span class="sc">\\</span></span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>      0.3125 &amp; \color{red}{1.28125} &amp; 0.3125 &amp; 0.28125 &amp; 0.3125 <span class="sc">\\</span></span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>      0.1875 &amp; 0.46875 &amp; \color{red}{1.1875} &amp; 0.46875 &amp; 0.1875 <span class="sc">\\</span></span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>      0.3125 &amp; 0.28125 &amp; 0.3125 &amp; \color{red}{1.28125} &amp; 0.3125 <span class="sc">\\</span></span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>      0.1875 &amp; 0.46875 &amp; 0.1875 &amp; 0.46875 &amp; \color{red}{1.1875}</span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}.</span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>As you can see, $(\bm I_N - \rho \bm W)^{-1}$ has \color{red}{diagonal elements} $&gt;1$: these are feedback loops. My $X$ influences my $Y$ directly, but my $Y$ then influences my neigbour's $Y$, which then influences my $Y$ again (also also other neighbour's $Y$s). Thus the influence of my $X$ on my $Y$ includes a spatial multiplier.</span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>Check yourself:</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>I <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">5</span>)</span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.6</span></span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>,</span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>,</span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> , <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span> , <span class="fl">0.5</span> , <span class="dv">0</span>), <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>(<span class="at">IrW =</span> I <span class="sc">-</span> rho<span class="sc">*</span>W)</span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a><span class="co"># (I - rho*W)^-1</span></span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>(<span class="at">M =</span> <span class="fu">solve</span>(IrW))</span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>The diagonal elements of indicate how each unit $i$ influences itself (change of $x_i$ on change of $y_i$), and each off-diagonal elements in column $j$ represents the effect of $j$ on each other unit $i$ (change of $x_j$ on change of $y_i$). </span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>      1.1875 &amp; \color{red}{0.46875} &amp; 0.1875 &amp; 0.46875 &amp; 0.1875 <span class="sc">\\</span></span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>      0.3125 &amp; 1.28125 &amp; 0.3125 &amp; 0.28125 &amp; 0.3125 <span class="sc">\\</span></span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>      0.1875 &amp; 0.46875 &amp; 1.1875 &amp; 0.46875 &amp; 0.1875 <span class="sc">\\</span></span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>      0.3125 &amp; 0.28125 &amp; 0.3125 &amp; 1.28125 &amp; 0.3125 <span class="sc">\\</span></span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>      0.1875 &amp; 0.46875 &amp; \color{blue}{0.1875} &amp; 0.46875 &amp; 1.1875</span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix}.</span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a>For instance, $\color{red}{W_{12}}$ indicates that unit 2 has an influence of 0.46875 on unit 1. On the other hand, $\color{blue}{W_{53}}$ indicates that unit 3 has an influence of magnitude 0.1875 on unit 5.</span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question</span></span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>Why does unit 3 have any effect o unit 5? According to $\bm W$ those two units are no neighbours $w_{53} = 0$!</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$  --&gt;</span></span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \begin{equation} --&gt;</span></span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \begin{split} --&gt;</span></span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        {\bm y} &amp; =\alpha{\bm \iota}+\rho {\bm W}{\bm y}+{\bm X}{\bm \beta}+{\bm \varepsilon} \\ --&gt;</span></span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        {\bm y} &amp; =({\bm I}-\rho{\bm W})^{-1}(\alpha{\bm \iota}+{\bm X}{\bm \beta}+{\bm \varepsilon}), --&gt;</span></span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \end{split} --&gt;</span></span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \end{equation} --&gt;</span></span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$  --&gt;</span></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- we can calculate the first derivative: --&gt;</span></span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$  --&gt;</span></span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \begin{equation} --&gt;</span></span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \begin{split} --&gt;</span></span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        \frac{\partial \bm y}{\partial \bm x_k} &amp; = ({\bm I}-\rho{\bm W})^{-1}\beta_k \\ --&gt;</span></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--        &amp; =({\bm I} + \rho{\bm W} + \rho^2{\bm W}^2 + \rho^3{\bm W}^3 + ...)\beta_k,  --&gt;</span></span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \end{split} --&gt;</span></span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    \end{equation}   --&gt;</span></span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$  --&gt;</span></span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--    where $\rho{\bm W}\beta_k$ equals the effect stemming from direct neighbours, $\rho^2{\bm W}^2\beta_k$ the effect stemming from second order neighbours (neighbours of neighbours),...  --&gt;</span></span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- for SAR, SAC, and SDM even the direct impacts differ from the point estimates. This results from the fact that an endogenous term of the dependent variable ${\bm W}{\bm y}$ contains feedback loops through the system of neighbours \citep{Betz.2019,Franzese.2007.0,HalleckVega.2015.0}. A change of $x_{i}$ in the focal unit $i$ influences the focal unit $i$ itself, but also the neighbouring unit $j$, which in turn influences the focal unit $i$ in a feedback loop. This feedback loop is part of the direct impact. --&gt;</span></span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Global and local spillovers</span></span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>The kind of indirect spillover effects in SAR, SAC, and SDM models differs from the kind of indirect spillover effects in SLX and SDEM models: while the first three specifications represent **global spillover effects**, the latter three represent **local spillover effects** <span class="co">[</span><span class="ot">@Anselin.2003; @LeSage.2009; @LeSage.2014</span><span class="co">]</span>. </span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>**Local*</span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>In case of SLX and SDEM the spatial spillover effects can be interpreted as the effect of a one unit change of ${\bm x}_k$ in the spatially weighted neighbouring observations on the dependent variable of the focal unit; when using a row-normalised contiguity weights matrix, ${\bm W} {\bm x}_k$ is the average value of ${\bm x}_k$ in the neighbouring units. Thus, only direct neighbours -- as defined in ${\bm W}$ -- contribute to those local spillover effects. </span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>**Global**</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>In contrast, spillover effects in SAR, SAC, and SDM models do not only include direct neighbours but also neighbours of neighbours (second order neighbours) and further higher-order neighbours. This can be seen by rewriting the inverse $({\bm I_N}-\rho {\bm W})^{-1}$ as power series:A power series of $\sum\nolimits_{k=0}^\infty {\bm W}^k$ converges to $({\bm I}-{\bm W})^{-1}$ if the maximum absolute eigenvalue of ${\bm W} &lt; 1$, which is ensured by standardising ${\bm W}$.}</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>({\bm I_N}-\rho {\bm W})^{-1}\beta_k </span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>=({\bm I_N} + \rho{\bm W} + \rho^2{\bm W}^2 + \rho^3{\bm W}^3 + ...)\beta_k </span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>= ({\bm I_N} + \sum_{h=1}^\infty \rho^h{\bm W}^h)\beta_k ,</span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>where the identity matrix represents the direct effects and the sum represents the first and higher order indirect effects and the above mentioned feedback loops. This implies that a change in one unit $i$ does not only affect the direct neighbours but passes through the whole system towards higher-order neighbours, where the impact declines with distance within the neighbouring system. Global indirect impacts thus are `multiplied' by influencing direct neighbours as specified in $\bm W$ and indirect neighbours not connected according to $\bm W$, with additional feedback loops between those neighbours.</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>All diagonal elements $\mathrm{diag}({\bm W})=w_{ii}=0$, whereas the diagonal elements  $\mathrm{diag}({\bm W}^2)=\mathrm{diag}({\bm W}{\bm W})\neq0$. Intuitively, $\rho{\bm W}$ only represents the effects between direct neighbours (and the focal unit is not a neighbour of the focal unit itself), whereas $\rho^2{\bm W}^2$ contains the effects of second order neighbours, where the focal unit is a second order neighbour of the focal unit itself. Thus, equation (\ref{eq:high}) includes feedback effects from $\rho^2{\bm W}^2$ on, which are part of the direct impacts according to the measures in Table \ref{table:imp}.</span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>In consequence, local and global spillover effects represent two distinct kinds of spatial spillover effects <span class="co">[</span><span class="ot">@LeSage.2014</span><span class="co">]</span>. The interpretation of local spillover effects is straightforward: it represents the effect of all neighbours as defined by ${\bm W}$ (the average over all neighbours in case of a row-normalised weights matrix). For instance, the environmental quality in the focal unit itself but also in neighbouring units could influence the attractiveness of a district and its house prices. In this example it seems reasonable to assume that we have local spillover effects: only the environmental quality in directly contiguous units (e.g. in walking distance) is relevant for estimating the house prices. In contrast, interpreting global spillover effects can be a bit more difficult. Intuitively, the global spillover effects can be seen as a kind of diffusion process. For example, an exogenous event might increase the house prices in one district of a city, thus leading to an adaptation of house prices in neighbouring districts, which then leads to further adaptations in other units (the neighbours of the neighbours), thereby globally diffusing the effect of the exogenous event due to the endogenous term. Yet, those processes happen over time. In a cross-sectional framework, the global spillover effects are hard to interpret. @Anselin.2003 proposes an interpretation as an equilibrium outcome, where the partial impact represents an estimate of how this long-run equilibrium would change due to a change in ${\bm x}_k$ <span class="co">[</span><span class="ot">@LeSage.2014</span><span class="co">]</span>.</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Impact measures</span></span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>Note that the derivative in SAR, SAC, and SDM is a $N \times N$ matrix, returning individual effects of each unit on each other unit, differentiated in _direct, indirect, and total impacts_. </span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>(\bm I_N - \rho \bm W)^{-1} \beta &amp;=</span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>      \color{red}{1.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} <span class="sc">\\</span></span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>      \color{blue}{0.3125} &amp; \color{red}{1.28125} &amp; \color{blue}{0.3125} &amp; \color{blue}{0.28125} &amp; \color{blue}{0.3125} <span class="sc">\\</span></span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>      \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{red}{1.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} <span class="sc">\\</span></span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>      \color{blue}{0.3125} &amp; \color{blue}{0.28125} &amp; \color{blue}{0.3125} &amp; \color{red}{1.28125} &amp; \color{blue}{0.3125} <span class="sc">\\</span></span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>      \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{blue}{0.1875} &amp; \color{blue}{0.46875} &amp; \color{red}{1.1875}</span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>      \end{pmatrix} \beta</span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>**However, the individual effects (how $i$ influences $j$) mainly vary because of variation in ${\bm W}$. **</span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a><span class="fu">## Do not interpret these as "estmated" individual impacts</span></span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>We estimate two scalar parameters in a SAR model: $\beta$ for the direct coefficient and $rho$ for the auto-regressive parameter.</span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>All variation in the effects matrix (\bm I_N - \rho \bm W)^{-1} \beta comes from the relationship in $\bm W$ which we have given a-priori!</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>Since reporting the individual partial effects is usually not of interest, @LeSage.2009 proposed to average over these effect matrices. While the average diagonal elements of the effects matrix $(\bm I_N - \rho \bm W)^{-1}$ represent the so called direct impacts of variable ${\bm x}_k$, the average column-sums of the off-diagonal elements represent the so called indirect impacts (or spatial spillover effects). </span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>The \color{red}{direct impacts} refer to an average effect of a unit change in $x_i$ on $y_i$, and \color{blue}{the indirect (spillover) impacts} indicate how a change in $x_i$, on average, influences all neighbouring units $y_j$.</span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>Though previous literature <span class="co">[</span><span class="ot">@HalleckVega.2015; @LeSage.2009</span><span class="co">]</span> has established the notation of direct and indirect impacts, it is important to note that also the direct impacts comprise a spatial `multiplier' component if we specify an endogenous lagged depended variable, as a change in $\bm x_i$ influences $\bm y_i$, which influences $\bm y_j$, which in turn influences $\bm y_i$ (see also equation \ref{eq:high}).</span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a>Usually, one should use summary measures to report effects in spatial models <span class="co">[</span><span class="ot">@LeSage.2009</span><span class="co">]</span>. @HalleckVega.2015 provide a nice summary of the impacts for each model:</span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>Model | Direct Impacts | Indirect Impacts | type</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>:-: | :-: | :-: | :-:</span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a>OLS/SEM | $\beta_k$ | -- | --</span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a>SAR/SAC | Diagonal elements of $({\bm I}-\rho{\bm W})^{-1}\beta_k$ | Off-diagonal elements of $({\bm I}-\rho{\bm W})^{-1}\beta_k$ | global</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>SLX/SDEM | $\beta_k$ | $\theta_k$ | local</span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a>SDM | Diagonal elements of $({\bm I}-\rho{\bm W})^{-1}\left<span class="co">[</span><span class="ot">\beta_k+{\bm W}\theta_k\right</span><span class="co">]</span>$ | Off-diagonal elements of $({\bm I}-\rho{\bm W})^{-1}$ |global</span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>The different indirect effects / spatial effects mean conceptionally different things:</span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Global spillover effects: SAR, SAC, SDM</span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Local spillover effects: SLX, SDEM</span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>We can calculate these impacts using <span class="in">`impacts()`</span> with simulated distributions, e.g. for the SAR model:</span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>mod_1.sar.imp <span class="ot">&lt;-</span> <span class="fu">impacts</span>(mod_1.sar, <span class="at">listw =</span> queens.lw, <span class="at">R =</span> <span class="dv">300</span>)</span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1.sar.imp, <span class="at">zstats =</span> <span class="cn">TRUE</span>, <span class="at">short =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative with traces (better for large W)</span></span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">as</span>(queens.lw, <span class="st">"CsparseMatrix"</span>)</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a>trMatc <span class="ot">&lt;-</span> <span class="fu">trW</span>(W, <span class="at">type=</span><span class="st">"mult"</span>)</span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>mod_1.sar.imp2 <span class="ot">&lt;-</span> <span class="fu">impacts</span>(mod_1.sar, <span class="at">tr =</span> trMatc, <span class="at">R =</span> <span class="dv">300</span>, <span class="at">Q =</span> <span class="dv">10</span>)</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_1.sar.imp2, <span class="at">zstats =</span> <span class="cn">TRUE</span>, <span class="at">short =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>The indirect effects in SAR, SAC, and SDM refer to global spillover effects. This means a change of $x$ in the focal units flows through the entire system of neighbours (direct nieightbours, neighbours of neighbours, ...) influencing 'their $y$'. One can think of this as diffusion or a change in a long-term equilibrium.</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>For SLX models, nothing is gained from computing the impacts.</span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">impacts</span>(mod_1.slx, <span class="at">listw =</span> queens.lw))</span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>